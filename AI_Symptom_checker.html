<!DOCTYPE html>

<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>AI Symptom Checker - HealthConsult</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            "primary": "#3A86FF",
            "secondary": "#43AA8B",
            "warning": "#F7B500",
            "background-light": "#F4F7F9",
            "background-dark": "#101922",
            "text-light": "#344054",
            "text-dark": "#D0D5DD",
            "text-light-secondary": "#6C757D",
            "text-dark-secondary": "#9DA7B2",
            "border-light": "#D0D5DD",
            "border-dark": "#344054",
            "surface-light": "#FFFFFF",
            "surface-dark": "#1D2939"
          },
          fontFamily: {
            "display": ["Inter", "sans-serif"]
          },
          borderRadius: {
            "DEFAULT": "0.5rem",
            "lg": "0.75rem",
            "xl": "1rem",
            "full": "9999px"
          },
        },
      },
    }
  </script>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-text-light dark:text-text-dark">
<div class="relative flex h-auto min-h-screen w-full flex-col group/design-root overflow-x-hidden">
<div class="layout-container flex h-full grow flex-col">
<!-- TopNavBar -->
<header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-border-light dark:border-border-dark px-6 md:px-10 lg:px-20 py-4 bg-surface-light dark:bg-surface-dark sticky top-0 z-50">
<div class="flex items-center gap-4 text-text-light dark:text-text-dark">
<div class="text-primary size-7">
<svg fill="currentColor" viewbox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
<path d="M24 45.8096C19.6865 45.8096 15.4698 44.5305 11.8832 42.134C8.29667 39.7376 5.50128 36.3314 3.85056 32.3462C2.19985 28.361 1.76794 23.9758 2.60947 19.7452C3.451 15.5145 5.52816 11.6284 8.57829 8.5783C11.6284 5.52817 15.5145 3.45101 19.7452 2.60948C23.9758 1.76795 28.361 2.19986 32.3462 3.85057C36.3314 5.50129 39.7376 8.29668 42.134 11.8833C44.5305 15.4698 45.8096 19.6865 45.8096 24L24 24L24 45.8096Z" fill="currentColor"></path>
</svg>
</div>
<h2 class="text-xl font-bold leading-tight tracking-[-0.015em]">HealthConsult</h2>
</div>
<div class="hidden md:flex flex-1 justify-center gap-8">
<nav class="flex items-center gap-9">
<a class="text-sm font-medium text-text-light-secondary dark:text-text-dark-secondary hover:text-primary dark:hover:text-primary" href="Patient_dashboard.html">Dashboard</a>
<a class="text-sm font-medium text-text-light-secondary dark:text-text-dark-secondary hover:text-primary dark:hover:text-primary" href="My_Appointments_patient.html">Appointments</a>
<a class="text-sm font-medium text-text-light-secondary dark:text-text-dark-secondary hover:text-primary dark:hover:text-primary" href="My_Medical_records.html">Records</a>
<a class="text-sm font-medium text-text-light-secondary dark:text-text-dark-secondary hover:text-primary dark:hover:text-primary" href="find_doctor.html">Find a Doctor</a>
</nav>
</div>
<div class="flex items-center gap-4">
<button class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 w-10 bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800 text-text-light dark:text-text-dark">
<span class="material-symbols-outlined">notifications</span>
</button>
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" data-alt="User's profile picture" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuAGwmRs3xWqNeo5-JrIvykSXw6PTNlEcHcbroYKYU7G_THRpyQwxSNa9uGO6u_MjGBpTMeMOfRUttKJbWa2SqUh7Q-zsJSQ1L22ehH1CqxWUY6yjgaMpIrxUdGwOk7wL_3PfWrIRH0-n0rm_C1FKhwBD-lRzGB63UqISMTANaj7jp5oOK3yShyei_6A5weSsSQNxKNpWkWR5h6MZOMm20mp4XBH_4ka_ZOVItoo93ed5WAiePhN5XIk7hiAcJO_JXXzn-vjZtu8G00");'></div>
</div>
</header>
<!-- Main Content -->
<main class="flex-1 w-full max-w-7xl mx-auto px-6 md:px-10 lg:px-20 py-10">
<div class="flex flex-col lg:flex-row gap-8">
<!-- Left Column: Chat Interface -->
<div class="w-full lg:w-1/2 flex flex-col">
<!-- Page Heading -->
<div class="mb-6">
<h1 class="text-4xl font-black leading-tight tracking-[-0.033em] text-text-light dark:text-white">How are you feeling today?</h1>
<p class="text-base font-normal leading-normal text-gray-500 dark:text-gray-400 mt-2">Describe your symptoms to get started. For example, 'sore throat and headache'.</p>
</div>
<!-- Chat Container -->
<div class="flex-1 flex flex-col bg-surface-light dark:bg-surface-dark rounded-xl shadow-sm border border-border-light dark:border-border-dark overflow-hidden">
<div class="flex-1 p-6 space-y-6 overflow-y-auto" style="max-height: 60vh;">
<!-- Chat Messages -->
<div class="flex items-end gap-3">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full w-10 h-10 shrink-0 bg-primary/10 flex items-center justify-center">
<span class="material-symbols-outlined text-primary">smart_toy</span>
</div>
<div class="flex flex-1 flex-col gap-1 items-start">
<p class="text-gray-500 dark:text-gray-400 text-sm font-medium leading-normal">AI Assistant</p>
<p class="text-base font-normal leading-normal flex max-w-md rounded-lg rounded-bl-none px-4 py-3 bg-gray-100 dark:bg-gray-700 text-text-light dark:text-text-dark">Hello! I'm here to help. Please describe your symptoms in the field below.</p>
</div>
</div>
<div class="flex items-end gap-3 justify-end">
<div class="flex flex-1 flex-col gap-1 items-end">
<p class="text-gray-500 dark:text-gray-400 text-sm font-medium leading-normal max-w-md text-right">You</p>
<p class="text-base font-normal leading-normal flex max-w-md rounded-lg rounded-br-none px-4 py-3 bg-primary text-white">I have a sore throat and headache</p>
</div>
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full w-10 h-10 shrink-0" data-alt="User's profile picture" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDOPy79zGpD3AOtuXqS2J2qy2GQzPc2kJy0o62Ow3cSyQ8ifege6FO1JkC298XR346Le1NXLHIyGIQbjR9RQGY4wqndsLFkjBsKyMIN7ymnGQ032RP__LglLRir1GcO81ITEthO6dYLcfK1gTbyMFC3unLtM4krB3sret-YFud45xn_t-RSybxJY-sPnSTE5SFGaLOVnvBLjNVv7Y_Wu9D0jbkgBTnPI9EB0be9EgOYCNpmxZ8bAtDKudT94kAnpkVkXSo-Th1xF-A");'></div>
</div>
<div class="flex items-end gap-3">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full w-10 h-10 shrink-0 bg-primary/10 flex items-center justify-center">
<span class="material-symbols-outlined text-primary">smart_toy</span>
</div>
<div class="flex flex-1 flex-col gap-1 items-start">
<p class="text-gray-500 dark:text-gray-400 text-sm font-medium leading-normal">AI Assistant</p>
<p class="text-base font-normal leading-normal flex max-w-md rounded-lg rounded-bl-none px-4 py-3 bg-gray-100 dark:bg-gray-700 text-text-light dark:text-text-dark">I understand. How long have you had these symptoms?</p>
<!-- Quick Reply Buttons -->
<div class="flex flex-wrap gap-2 pt-3">
<button class="px-4 py-2 text-sm font-medium text-primary bg-primary/10 dark:bg-primary/20 hover:bg-primary/20 dark:hover:bg-primary/30 rounded-full">Less than a day</button>
<button class="px-4 py-2 text-sm font-medium text-primary bg-primary/10 dark:bg-primary/20 hover:bg-primary/20 dark:hover:bg-primary/30 rounded-full">1-3 days</button>
<button class="px-4 py-2 text-sm font-medium text-primary bg-primary/10 dark:bg-primary/20 hover:bg-primary/20 dark:hover:bg-primary/30 rounded-full">More than 3 days</button>
</div>
</div>
</div>
<div class="flex items-center gap-3">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full w-10 h-10 shrink-0 bg-primary/10 flex items-center justify-center">
<span class="material-symbols-outlined text-primary">smart_toy</span>
</div>
<div class="flex items-center gap-2">
<span class="w-2 h-2 bg-gray-400 rounded-full animate-pulse" style="animation-delay: 0s;"></span>
<span class="w-2 h-2 bg-gray-400 rounded-full animate-pulse" style="animation-delay: 0.2s;"></span>
<span class="w-2 h-2 bg-gray-400 rounded-full animate-pulse" style="animation-delay: 0.4s;"></span>
</div>
</div>
</div>
<!-- Input Field -->
<div class="p-4 border-t border-border-light dark:border-border-dark">
<div class="relative">
<input class="w-full pl-4 pr-12 py-3 rounded-lg border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark focus:ring-2 focus:ring-primary focus:border-primary transition duration-150" placeholder="Enter your symptoms here..." type="text"/>
<button class="absolute right-2 top-1/2 -translate-y-1/2 flex items-center justify-center w-9 h-9 bg-primary text-white rounded-lg hover:bg-blue-500 transition-colors">
<span class="material-symbols-outlined text-xl">send</span>
</button>
</div>
<p class="text-xs text-gray-500 dark:text-gray-400 mt-2 text-center">Your health data is kept private and secure. <a class="underline hover:text-primary" href="#">Learn more</a>.</p>
</div>
</div>
</div>
<!-- Right Column: Results Display -->
<div class="w-full lg:w-1/2 flex flex-col pt-0 lg:pt-20">
<div class="sticky top-28">
<!-- Results Card -->
<div class="bg-surface-light dark:bg-surface-dark rounded-xl shadow-sm border border-border-light dark:border-border-dark p-6">
<h2 class="text-2xl font-bold text-text-light dark:text-white">Preliminary Analysis</h2>
<p class="text-gray-500 dark:text-gray-400 mt-1">Based on the symptoms you provided.</p>
<!-- Warning Banner -->
<div class="mt-4 flex items-start gap-3 p-4 rounded-lg bg-warning/10 text-warning">
<span class="material-symbols-outlined mt-0.5">warning</span>
<p class="text-sm font-medium">This is for informational purposes only and is not a substitute for professional medical advice. Consult a doctor for an accurate diagnosis.</p>
</div>
<div class="mt-6 animate-pulse">
<h3 class="font-semibold text-text-light dark:text-white">Severity Level: <span class="text-warning font-bold">Moderate</span></h3>
<div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 mt-2">
<div class="bg-warning h-2.5 rounded-full" style="width: 60%"></div>
</div>
</div>
<div class="mt-6 space-y-4">
<h3 class="font-semibold text-text-light dark:text-white">Possible Causes</h3>
<div id="cause-common-cold" class="p-4 border border-border-light dark:border-border-dark rounded-lg animate-pulse">
<h4 class="font-bold text-primary">Common Cold</h4>
<p class="text-sm text-gray-500 dark:text-gray-400 mt-1">A viral infection of your nose and throat. Usually harmless, although it might not feel that way.</p>
</div>
<div id="cause-influenza" class="p-4 border border-border-light dark:border-border-dark rounded-lg">
<h4 class="font-bold text-primary">Influenza (Flu)</h4>
<p class="text-sm text-gray-500 dark:text-gray-400 mt-1">A contagious respiratory illness caused by influenza viruses. It can cause mild to severe illness.</p>
</div>
<div id="cause-strep-throat" class="p-4 border border-border-light dark:border-border-dark rounded-lg">
<h4 class="font-bold text-primary">Strep Throat</h4>
<p class="text-sm text-gray-500 dark:text-gray-400 mt-1">A bacterial infection that can make your throat feel sore and scratchy.</p>
</div>
</div>
<div class="mt-8">
<h3 class="font-semibold text-text-light dark:text-white">Recommendations</h3>
<p class="text-sm text-gray-500 dark:text-gray-400 mt-1">We recommend you speak with a General Practitioner to discuss your symptoms further.</p>
<div id="recommendation-buttons" class="mt-4 flex flex-col sm:flex-row gap-3">
<a href="My_Appointments_patient.html" class="flex-1 flex items-center justify-center gap-2 px-6 py-3 bg-primary text-white font-bold rounded-lg hover:bg-blue-500 transition-colors">
<span class="material-symbols-outlined">video_call</span>
                    Book a Consultation
                  </a>
<a href="find_doctor.html" class="flex-1 flex items-center justify-center gap-2 px-6 py-3 bg-gray-100 dark:bg-gray-700 text-text-light dark:text-text-dark font-bold rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
<span class="material-symbols-outlined">person_search</span>
                    Find a Specialist
                  </a>
</div>
</div>
</div>
</div>
</div>
</div>
</main>
</div>
</div>

<script type="module">
    const chatMessages = document.querySelector('.flex-1.p-6.space-y-6');
    const userInput = document.querySelector('.p-4.border-t input');
    const sendButton = document.querySelector('.p-4.border-t button');
    const rightColumn = document.querySelector('.sticky.top-28');

    let conversationState = {
        step: 0,
        symptoms: [],
        duration: '',
        fever: null,
        otherSymptoms: []
    };

    function escapeHtml(s) { return s.replace(/[&<>"']/g, c => ({ '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;' }[c])); }

    function createMessage(html) {
        const wrapper = document.createElement('div');
        wrapper.innerHTML = html.trim();
        return wrapper.firstChild;
    }

    function addUserMessage(text) {
        const messageHtml = `
            <div class="flex items-end gap-3 justify-end">
                <div class="flex flex-1 flex-col gap-1 items-end">
                    <p class="text-gray-500 dark:text-gray-400 text-sm font-medium">You</p>
                    <p class="text-base font-normal leading-normal flex max-w-md rounded-lg rounded-br-none px-4 py-3 bg-primary text-white">${escapeHtml(text)}</p>
                </div>
                <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full w-10 h-10 shrink-0" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDOPy79zGpD3AOtuXqS2J2qy2GQzPc2kJy0o62Ow3cSyQ8ifege6FO1JkC298XR346Le1NXLHIyGIQbjR9RQGY4wqndsLFkjBsKyMIN7ymnGQ032RP__LglLRir1GcO81ITEthO6dYLcfK1gTbyMFC3unLtM4krB3sret-YFud45xn_t-RSybxJY-sPnSTE5SFGaLOVnvBLjNVv7Y_Wu9D0jbkgBTnPI9EB0be9EgOYCNpmxZ8bAtDKudT94kAnpkVkXSo-Th1xF-A");'></div>
            </div>`;
        appendMessage(createMessage(messageHtml));
    }

    function addAssistantMessage(text, quickReplies = []) {
        let quickReplyHtml = '';
        if (quickReplies.length > 0) {
            quickReplyHtml = `<div class="flex flex-wrap gap-2 pt-3">
                ${quickReplies.map(reply => `<button class="quick-reply-btn px-4 py-2 text-sm font-medium text-primary bg-primary/10 dark:bg-primary/20 hover:bg-primary/20 dark:hover:bg-primary/30 rounded-full">${escapeHtml(reply)}</button>`).join('')}
            </div>`;
        }
        const messageHtml = `
            <div class="flex items-end gap-3">
                <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full w-10 h-10 shrink-0 bg-primary/10 flex items-center justify-center">
                    <span class="material-symbols-outlined text-primary">smart_toy</span>
                </div>
                <div class="flex flex-1 flex-col gap-1 items-start">
                    <p class="text-gray-500 dark:text-gray-400 text-sm font-medium">AI Assistant</p>
                    <p class="text-base font-normal leading-normal flex max-w-md rounded-lg rounded-bl-none px-4 py-3 bg-gray-100 dark:bg-gray-700 text-text-light dark:text-text-dark">${escapeHtml(text)}</p>
                    ${quickReplyHtml}
                </div>
            </div>`;
        const messageElement = createMessage(messageHtml);
        appendMessage(messageElement);

        messageElement.querySelectorAll('.quick-reply-btn').forEach(button => {
            button.addEventListener('click', () => {
                handleUserInput(button.textContent);
                // Disable quick replies after use
                messageElement.querySelectorAll('.quick-reply-btn').forEach(btn => {
                    btn.disabled = true;
                    btn.classList.add('opacity-50', 'cursor-not-allowed');
                });
            });
        });
    }

    function appendMessage(element) {
        chatMessages.appendChild(element);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function handleUserInput(text) {
        if (!text || !text.trim()) return;
        addUserMessage(text);
        userInput.value = '';
        
        // Add a thinking indicator
        const thinkingHtml = `<div class="flex items-center gap-3" id="thinking-indicator">
            <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full w-10 h-10 shrink-0 bg-primary/10 flex items-center justify-center">
                <span class="material-symbols-outlined text-primary">smart_toy</span>
            </div>
            <div class="flex items-center gap-2">
                <span class="w-2 h-2 bg-gray-400 rounded-full animate-pulse" style="animation-delay: 0s;"></span>
                <span class="w-2 h-2 bg-gray-400 rounded-full animate-pulse" style="animation-delay: 0.2s;"></span>
                <span class="w-2 h-2 bg-gray-400 rounded-full animate-pulse" style="animation-delay: 0.4s;"></span>
            </div>
        </div>`;
        appendMessage(createMessage(thinkingHtml));

        setTimeout(() => {
            document.getElementById('thinking-indicator')?.remove();
            processStaticAI(text);
        }, 1200);
    }

    function processStaticAI(text) {
        const state = conversationState;
        switch (state.step) {
            case 0: // Initial symptoms
                state.symptoms = text.toLowerCase().split(/and|,|\s+/).filter(s => s.trim().length > 2);
                addAssistantMessage("I understand. How long have you been experiencing these symptoms?", ["Less than a day", "1-3 days", "More than 3 days"]);
                state.step = 1;
                break;
            case 1: // Duration
                state.duration = text;
                addAssistantMessage("Got it. Do you have a fever?", ["Yes, high fever", "Yes, a slight fever", "No fever"]);
                state.step = 2;
                break;
            case 2: // Fever
                state.fever = text.toLowerCase();
                addAssistantMessage("Are you experiencing any of these other symptoms?", ["Cough", "Body Aches", "Fatigue", "None of these"]);
                state.step = 3;
                break;
            case 3: // Other symptoms
                if (!text.toLowerCase().includes('none')) {
                    state.otherSymptoms.push(text.toLowerCase());
                }
                // Final analysis
                const fullSymptomList = [...state.symptoms, ...state.otherSymptoms].join(', ');
                const analysisText = `Based on your symptoms of '${fullSymptomList}' for '${state.duration}', I have completed a preliminary analysis. Please see the results on the right. Remember, this is not a medical diagnosis.`;
                addAssistantMessage(analysisText, ["Start New Check"]);
                runAnalysis();
                state.step = 4;
                break;
            case 4: // Restart
            default:
                conversationState = { step: 0, symptoms: [], duration: '', fever: null, otherSymptoms: [] };
                chatMessages.innerHTML = ''; // Clear chat
                addAssistantMessage("Hello! I'm here to help. Please describe your symptoms in the field below.");
                break;
        }
    }

    function runAnalysis() {
        // This is a simplified analysis based on the conversation state.
        let severity = 30;
        let causes = [{ name: 'Common Cold', score: 40 }, { name: 'Allergies', score: 35 }];

        if (conversationState.symptoms.includes('headache')) severity += 10;
        if (conversationState.duration.includes('3 days')) severity += 15;
        if (conversationState.fever?.includes('high')) {
            severity += 25;
            causes.unshift({ name: 'Influenza (Flu)', score: 75 });
        }
        if (conversationState.otherSymptoms.includes('body aches')) {
            severity += 20;
            causes.unshift({ name: 'Viral Infection', score: 70 });
        }
        
        severity = Math.min(95, severity); // Cap severity
        causes.sort((a, b) => b.score - a.score);

        updateResults({ severity, causes: causes.slice(0, 3) });
    }

    function updateResults({ severity, causes }) {
        rightColumn.querySelectorAll('.animate-pulse').forEach(el => el.classList.remove('animate-pulse'));
        const severityEl = rightColumn.querySelector('.mt-6');
        const causesContainer = rightColumn.querySelector('.mt-6.space-y-4');

        const percent = severity;
        const colorClass = percent >= 70 ? 'text-red-600' : (percent >= 40 ? 'text-warning' : 'text-green-600');
        const bgColor = percent >= 70 ? '#F94144' : (percent >= 40 ? '#F7B500' : '#43AA8B');

        severityEl.innerHTML = `
            <h3 class="font-semibold text-text-light dark:text-white">Severity Level: <span class="${colorClass} font-bold">${percent > 0 ? `${percent}%` : 'Low'}</span></h3>
            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 mt-2">
                <div class="h-2.5 rounded-full" style="width: ${percent}%; background-color: ${bgColor};"></div>
            </div>`;

        const causesHtml = causes.map(c => `
            <div class="p-4 border border-border-light dark:border-border-dark rounded-lg">
                <h4 class="font-bold text-primary">${escapeHtml(c.name)}</h4>
                <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Estimated likelihood based on symptoms.</p>
            </div>`).join('');
        
        causesContainer.innerHTML = `<h3 class="font-semibold text-text-light dark:text-white">Possible Causes</h3>` + causesHtml;
    }

    // --- Event Listeners ---
    sendButton.addEventListener('click', () => handleUserInput(userInput.value));
    userInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
            e.preventDefault();
            handleUserInput(userInput.value);
        }
    });

    // Initial state
    document.addEventListener('DOMContentLoaded', () => {
        // Remove static messages from HTML
        chatMessages.innerHTML = '';
        addAssistantMessage("Hello! I'm here to help. Please describe your symptoms in the field below.");
    });
</script>
</body></html>